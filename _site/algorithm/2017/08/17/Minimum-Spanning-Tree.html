<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      최소 스패닝 트리(Minimum Spanning Tree) &middot; Pleasure of Learning
    
  </title>
  <!-- FONT -->
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" />

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
  <link rel="stylesheet" href="/public/css/mycss.css">
  
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  <!-- MathJax -->
  
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  
</head>


  <body>
  
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>This Blog is using my study.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about.html">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive.html">Archive</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/category.html">Category</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/tags.html">Tags</a>
        
      
    
<!--
    <a class="sidebar-nav-item" href="/archive/v1.0.1.zip">Download</a>
    <a class="sidebar-nav-item" href="">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.0.1</span> -->
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2018. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Pleasure of Learning</a>
            <small></small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">최소 스패닝 트리(Minimum Spanning Tree)</h1>
  <span class="post-date"><time>17 Aug 2017</time></span>
  <div class="post-tags">
      
        <a class="post-tags-item" href="http://localhost:4000/tags#graph">
          <span>graph</span>
        </a>
      
        <a class="post-tags-item" href="http://localhost:4000/tags#minimum spanning tree">
          <span>minimum spanning tree</span>
        </a>
      
        <a class="post-tags-item" href="http://localhost:4000/tags#tree">
          <span>tree</span>
        </a>
      
        <a class="post-tags-item" href="http://localhost:4000/tags#kruskal algorithm">
          <span>kruskal algorithm</span>
        </a>
      
        <a class="post-tags-item" href="http://localhost:4000/tags#prim algorithm">
          <span>prim algorithm</span>
        </a>
      
        <a class="post-tags-item" href="http://localhost:4000/tags#disjoint set">
          <span>disjoint set</span>
        </a>
      
  </div>

  <h2 id="최소-스패닝-트리란">최소 스패닝 트리란?</h2>

<p>최소 스패닝 트리(이하 MST)는 연결된 무방향 가중치 그래프 <script type="math/tex">G</script>에서 정의되는 개념으로 간선의 부분 집합 <script type="math/tex">E' \in E</script>을 선택하여 그래프를 재구성하여 만들 수 있는 그래프 <script type="math/tex">G'</script>(트리)로 다음과 같은 특징들을 만족해야 한다.</p>

<ul>
  <li>연결된 그래프여야 한다.</li>
  <li>사이클을 없어야 한다. 즉, 루트 없는 트리 형태여야 한다.</li>
  <li>간선들의 가중치 합이 최소가 되어야 한다.</li>
</ul>

<p>MST를 구하는 대표적인 알고리즘으로 크루스칼 알고리즘과 프림 알고리즘이 있다. 두 알고리즘 모두 탐욕적 알고리즘으로 바로 이어서 설명한다.</p>

<h3 id="크루스칼kruskal-알고리즘">크루스칼(Kruskal) 알고리즘</h3>

<p>크루스칼 알고리즘은 그래프의 모든 간선을 가중치의 오름차순으로 정렬한 뒤, 가중치가 작은 간선부터 스패닝 트리에 추가해 나간다. 다만 간선 추가시 이미 스패닝 트리에 포함된 간선들과 사이클을 이룬다면 추가하지 않고 넘어간다. 이러한 탐욕적 선택의 정당성은 쉽게 확인할 수 있다. 가장 작은 가중치의 간선 <strong><em>e = (u, v)</em></strong>를 포함하지 않는 스패닝 트리 <strong><em>T</em></strong>가 있다고 가정하면, <strong><em>T</em></strong>에서 <strong><em>u</em></strong>와 <strong><em>v</em></strong>를 연결하는 경로를 이루는 간선들의 가중치는 모두 <strong><em>e</em></strong> 보다 크거나 같다. 이 간선들 중 하나를 빼고 <strong><em>e</em></strong>를 스패닝 트리에 추가해도 가중치는 증가하지 않고 최소 스패닝 트리를 이룬다. 따라서 가장 작은 가중치를 선택하는 것이 최소 스패닝 트리를 구성할 수 있다는 것을 확인할 수 있다. 이미 연결된 정점들을 하나의 정점이라고 생각하면 최적 부분 구조 또한 성립함을 알 수 있다.</p>

<p>크루스칼 알고리즘을 구현할 때, 간선 <strong><em>(u, v)</em></strong>를 추가했을 때, 그래프가 사이클을 이루는지 확인하는데 UnionFind 자료 구조를 사용하면 효율적으로 이를 확인할 수 있다. UnionFind 자료 구조의 연산은 사실상 상수 시간이기 때문에 알고리즘의 시간복잡도는 간선을 정렬하는데 걸리는 시간 <script type="math/tex">O(E \space log_2{V})</script>과 같다.</p>

<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="k">struct</span> <span class="n">UnionFind</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">V</span><span class="p">;</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">adj</span><span class="p">[</span><span class="n">MAX_V</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">kruskal</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">vector</span><span class="o">&lt;</span><span class="n">tuple</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">edges</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="n">V</span><span class="p">;</span> <span class="n">u</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span> <span class="n">p</span> <span class="o">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="p">{</span>
      <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
      <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
      <span class="n">edges</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">make_tuple</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">sort</span><span class="p">(</span><span class="n">edges</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">edges</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
  
  <span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">selected</span><span class="p">;</span> <span class="c1">// edge set that forms the minimum spanning tree
</span>  <span class="n">UnionFind</span> <span class="n">sets</span><span class="p">(</span><span class="n">V</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span> <span class="n">tp</span> <span class="o">:</span> <span class="n">edges</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">cost</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span>
    <span class="n">tie</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">tp</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sets</span><span class="p">.</span><span class="n">are_same_set</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">sets</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
      <span class="n">selected</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">make_pair</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h3 id="프림prim-알고리즘">프림(Prim) 알고리즘</h3>

<p>프림 알고리즘은 하나의 시작점으로 구성된 트리에서부터 시작해 트리와 연결된 간선들 중 사이클을 만들지 않는 최소 가중치 간선을 추가해나가면서 최소 스패닝 트리를 만든다. 시간복잡도는  <script type="math/tex">O(E \space log_2{V})</script>로 크루스칼 알고리즘과 같다.</p>

<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">prim</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">mst_cost</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span><span class="p">,</span> <span class="n">greater</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;&gt;</span> <span class="n">pq</span><span class="p">;</span>
  <span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span> <span class="n">taken</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">taken</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span> <span class="n">p</span> <span class="o">:</span> <span class="n">adj</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">there</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">ncost</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">taken</span><span class="p">[</span><span class="n">there</span><span class="p">])</span> <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">make_pair</span><span class="p">(</span><span class="n">ncost</span><span class="p">,</span> <span class="n">there</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">pq</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">here</span> <span class="o">=</span> <span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">first</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">().</span><span class="n">second</span><span class="p">;</span>
    <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">taken</span><span class="p">[</span><span class="n">here</span><span class="p">])</span> <span class="p">{</span>
      <span class="n">mst_cost</span> <span class="o">+=</span> <span class="n">cost</span><span class="p">;</span>
      <span class="n">taken</span><span class="p">[</span><span class="n">here</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span> <span class="n">p</span> <span class="o">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">here</span><span class="p">])</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">there</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">ncost</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">taken</span><span class="p">[</span><span class="n">there</span><span class="p">])</span> <span class="n">pq</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">make_pair</span><span class="p">(</span><span class="n">ncost</span><span class="p">,</span> <span class="n">there</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="연습-문제">연습 문제</h2>

<p><strong>BOJ 1922 네트워크 연결 (<a href="https://www.acmicpc.net/problem/1922">문제 보기</a>)</strong></p>

<p><strong>BOJ 2887 행성 터널 (<a href="https://www.acmicpc.net/problem/2887">문제 보기</a>)</strong></p>

<p><strong>BOJ 1647 도시 분할 계획 (<a href="https://www.acmicpc.net/problem/1647">문제 보기</a>)</strong></p>

<h2 id="참고-자료">참고 자료</h2>

<ul>
  <li>프로그래밍 대회에서 배우는 알고리즘 문제해결전략, 구종만</li>
  <li>Competive Programming 3, Steven Halim</li>
</ul>


</div>

<div class="share">
	<br>
    <p>Share this post with: </p>
	<a href="https://twitter.com/intent/tweet?text=최소 스패닝 트리(Minimum Spanning Tree)@&amp;url=http://localhost:4000/algorithm/2017/08/17/Minimum-Spanning-Tree.html" class="twitter-share">
		<span class="fa-stack fa-lg">
			<i class="fa fa-circle fa-stack-2x"></i>
			<i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
		</span>
	</a>

	<a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/algorithm/2017/08/17/Minimum-Spanning-Tree.html" class="facebook-share">
		<span class="fa-stack fa-lg">
			<i class="fa fa-circle fa-stack-2x"></i>
			<i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
		</span>
	</a>

	<a href="https://plus.google.com/share?url=http://localhost:4000/algorithm/2017/08/17/Minimum-Spanning-Tree.html" class="googleplus-share">
		<span class="fa-stack fa-lg">
			<i class="fa fa-circle fa-stack-2x"></i>
			<i class="fa fa-google-plus fa-stack-1x fa-inverse"></i>
		</span>
	</a>
</div>


<div class="comments">
    
		<div id="disqus_thread"></div>
		<script>

		/**
		*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
		*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
		/*
		var disqus_config = function () {
		this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
		this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
		};
		*/
		(function() { // DON'T EDIT BELOW THIS LINE
		var d = document, s = d.createElement('script');
		s.src = 'https://museop.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		(d.head || d.body).appendChild(s);
		})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
    
</div>



<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/algorithm/2017/09/12/Binary-Search.html">
            이진 탐색(Binary Search)
            <small>12 Sep 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/data%20structure/2017/09/12/Binary-Search-Tree.html">
            이진검색트리(Binary Search Tree)
            <small>12 Sep 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/data%20structure/2017/09/11/Square-Decomposition.html">
            평방 분할 기법(Square Root Decomposition)
            <small>11 Sep 2017</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
